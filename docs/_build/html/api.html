
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DiskArray API Documentation &#8212; diskarray 0.1a1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="DiskArray" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-diskarray.diskarray">
<span id="diskarray-api-documentation"></span><h1>DiskArray API Documentation<a class="headerlink" href="#module-diskarray.diskarray" title="Permalink to this headline">¶</a></h1>
<p>DiskArray is a Python library for storing numeric data arrays in a format
that is as open and simple as possible. It also provides easy memory-mapped
access to such disk-based data using numpy indexing.</p>
<p>Diskarray objects can be created from array-like objects, such as numpy arrays
and lists, using the <strong>asdiskarray</strong> function. Alternatively, diskarrays can be
created from scratch by the <strong>create_diskarray</strong> function. Existing diskarray
data on disk can be accessed through the <strong>DiskArray</strong> constructor.
To remove a diskarray from disk, use <strong>delete_diskarray</strong>.</p>
<div class="section" id="creating-diskarrays">
<h2>Creating diskarrays<a class="headerlink" href="#creating-diskarrays" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="diskarray.asdiskarray">
<code class="descclassname">diskarray.</code><code class="descname">asdiskarray</code><span class="sig-paren">(</span><em>path</em>, <em>array</em>, <em>dtype=None</em>, <em>accessmode='r'</em>, <em>metadata=None</em>, <em>chunklen=None</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.asdiskarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an array or array generator as a DiskArray to file system path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – File system path to which the array will be saved. Note that this will
be a directory containing multiple files.</li>
<li><strong>array</strong> (<em>array-like object</em><em> or </em><em>generator yielding array-like objects</em>) – This can be a numpy array, a sequence that can be converted into a
numpy array, or a generator that yields such objects. The latter will
be concatenated along the first dimension.</li>
<li><strong>dtype</strong> (<cite>numpy dtype</cite>, optional) – Is inferred from the data if <cite>None</cite>. If <cite>dtype</cite> is provided the data
will be cast to <cite>dtype</cite>. Default is <cite>None</cite>.</li>
<li><strong>accessmode</strong> ({<cite>r</cite>, <cite>r+</cite>}, optional) – File access mode of the disk array that is returned. <cite>r</cite> means
read-only, <cite>r+</cite> means read-write. In the latter case, data can be
changed. Default <cite>r</cite>.</li>
<li><strong>metadata</strong> (<em>{None</em><em>, </em><em>dict}</em>) – Dictionary with metadata to be saved in a separate JSON file. Default</li>
<li><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are read and written
during the process. If None and the <cite>array</cite> is a numpy array or
diskarray, it is chosen so that chunks are 10 Mb in total size. If
None and <cite>array</cite> is a generator or sequence, chunklen will be 1.</li>
<li><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing diskarray data if it exists. Note that a diskarray
path is a directory. If that directory contains additional files,
these will not be removed and an OSError is raised. Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A <cite>DiskArray</cite> instance.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-func docutils literal"><span class="pre">create_diskarray()</span></code></dt>
<dd>create a DiskArray from scratch.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asdiskarray</span><span class="p">(</span><span class="s1">&#39;data.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">diskarray([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asdiskarray</span><span class="p">(</span><span class="s1">&#39;data.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">diskarray([ 0.,  1.,  2.,  3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">asdiskarray</span><span class="p">(</span><span class="s1">&#39;data_rw.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">accessmode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span>
<span class="go">diskarray([0, 1, 2, 3, 4, 5]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span>
<span class="go">diskarray([0, 1, 2, 3, 4, 8]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="go">diskarray([9, 1, 9, 3, 9, 8]) (r+)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="diskarray.create_diskarray">
<code class="descclassname">diskarray.</code><code class="descname">create_diskarray</code><span class="sig-paren">(</span><em>path</em>, <em>shape</em>, <em>dtype='float64'</em>, <em>fill=None</em>, <em>fillfunc=None</em>, <em>accessmode='r+'</em>, <em>chunklen=None</em>, <em>metadata=None</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.create_diskarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <cite>DiskArray</cite> of given shape and type, filled with
predetermined values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – File system path to which the array will be saved. Note that this will
be a directory containing multiple files.</li>
<li><strong>shape</strong> (<em>int ot sequence of ints</em>) – Shape of the <cite>DiskArray</cite>.</li>
<li><strong>dtype</strong> (<a class="reference internal" href="#diskarray.DiskArray.dtype" title="diskarray.DiskArray.dtype"><em>dtype</em></a><em>, </em><em>optional</em>) – The type of the <cite>DiskArray</cite>. Default is ‘float64’</li>
<li><strong>fill</strong> (<em>number</em><em>, </em><em>optional</em>) – The value used to fill the array with. Default is <cite>None</cite>, which will
lead to the array being filled with zeros.</li>
<li><strong>fillfunc</strong> (<em>function</em><em>, </em><em>optional</em>) – A function that generates the fill values, potentially on the basis of
the index numbers of axis 0. This function should only have one
argument, which will be automatically provided during filling and
which represents the index numbers along axis 0 for all dimensions (see
example below). If <cite>fillfunc</cite> is provided, <cite>fill</cite> should be <cite>None</cite>.
And vice versa. Default is None.</li>
<li><strong>accessmode</strong> (&lt;<cite>r</cite>, <cite>r+</cite>&gt;, optional) – File access mode of the disk array data. <cite>r</cite> means real-only, <cite>r+</cite>
means read-write, i.e. values can be changed. Default <cite>r</cite>.</li>
<li><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are written during
creation. If None, it is chosen so that chunks are 10 Mb in total size.</li>
<li><strong>metadata</strong> (<em>{None</em><em>, </em><em>dict}</em>) – Dictionary with metadata to be saved in a separate JSON file. Default
None</li>
<li><strong>overwrite</strong> (<em>&lt;True</em><em>, </em><em>False&gt;</em><em>, </em><em>optional</em>) – Overwrites existing diskarray data if it exists. Note that a diskarray
paths is a directory. If that directory contains additional files,
these will not be removed and an OSError is raised.
Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A <cite>DiskArray</cite> instance.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-func docutils literal"><span class="pre">asdiskarray()</span></code></dt>
<dd>create a DiskArray from existing array-like object or generator.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray0&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">diskarray([[ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray1&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int16&#39;</span><span class="p">)</span>
<span class="go">diskarray([[0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0]], dtype=int16) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray3&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="mf">23.4</span><span class="p">)</span>
<span class="go">diskarray([[ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="c1"># i is index along first axis of diskarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray4&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="go">diskarray([ 0.,  2.,  4.,  6.,  8.]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray4&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="go">diskarray([[ 0.,  0.],</span>
<span class="go">   [ 1.,  2.],</span>
<span class="go">   [ 2.,  4.],</span>
<span class="go">   [ 3.,  6.],</span>
<span class="go">   [ 4.,  8.]]) (r+)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="accessing-existing-diskarrays">
<h2>Accessing existing diskarrays<a class="headerlink" href="#accessing-existing-diskarrays" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="diskarray.DiskArray">
<em class="property">class </em><code class="descclassname">diskarray.</code><code class="descname">DiskArray</code><span class="sig-paren">(</span><em>path</em>, <em>accessmode='r'</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and write numeric data from and to a memory-mapped, disk-based
array using numpy indexing. Memory-mapped arrays are used for accessing
segments of (very) large files on disk, without reading the entire file
into memory.</p>
<p>Diskarray data is stored in a simple format that maximizes long-term
readability by other software and programming languages, and has been
designed with scientific use cases in mind.</p>
<p>A diskarray corresponds to a directory containing 1) a binary file with
the raw numeric array values, 2) a text file (json format) describing the
numeric type, array shape, and other format information, 3) a README text
file documenting the data format, including examples of how to read the
data in Python or Matlab.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to disk-based array directory.</li>
<li><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the disk array data. <cite>r</cite> means read-only, <cite>r+</cite> means
read-write. <cite>w</cite> does not exist. To create new diskarrays, potentially
overwriting an other one, use the <cite>asdiskarray</cite> or <cite>create_diskarray</cite>
functions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="diskarray.DiskArray.accessmode">
<code class="descname">accessmode</code><a class="headerlink" href="#diskarray.DiskArray.accessmode" title="Permalink to this definition">¶</a></dt>
<dd><p>File access mode of the disk array data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write. <cite>w</cite> does not exist. To create new diskarrays,
potentially overwriting an other one, use the <cite>asdiskarray</cite> or
<cite>create_diskarray</cite> functions.</p>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Add array-like objects to diskarray to the end of the dataset.</p>
<p>Data will be appended along the first axis. The shape of the data and
the diskarray must be compliant. When appending data repeatedly it is
more efficient to use <cite>iterappend</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> (<em>array-like object</em>) – This can be a numpy array, a sequence that can be converted into a
numpy array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 1.  2.]</span>
<span class="go"> [ 3.  4.]</span>
<span class="go"> [ 5.  6.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>path</em>, <em>dtype=None</em>, <em>chunklen=None</em>, <em>accessmode='r'</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy diskarray to a different path, potentially changing its dtype.</p>
<p>The copying is performed in chunks to avoid RAM memory overflow for
very large diskarrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – </li>
<li><strong>dtype</strong> (<em>&lt;dtype</em><em>, </em><em>None&gt;</em>) – Numpy data type of the copy. Default is None, which corresponds to
the dtype of the diskarray to be copied.</li>
<li><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are written during
creation. If None, it is chosen so that chunks are 10 Mb in total
size.</li>
<li><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the disk array data of the returned DiskArray
object. <cite>r</cite> means read-only, <cite>r+</cite> means read-write.</li>
<li><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing diskarray data if it exists. Note that a
diskarray path is a directory. If that directory contains
additional files, these will not be removed and an OSError is
raised. Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">copy of the diskarray</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#diskarray.DiskArray" title="diskarray.DiskArray">DiskArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.currentchecksums">
<code class="descname">currentchecksums</code><a class="headerlink" href="#diskarray.DiskArray.currentchecksums" title="Permalink to this definition">¶</a></dt>
<dd><p>Current md5 checksums of data and datadescription files.</p>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#diskarray.DiskArray.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of the array values.</p>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.iterappend">
<code class="descname">iterappend</code><span class="sig-paren">(</span><em>arrayiterable</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.iterappend" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively append data from a data iterable.</p>
<p>The iterable has to yield chunks of data that are array-like objects
compliant with the diskarray.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>arrayiterable</strong> (<em>an iterable that yield array-like objects</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ga</span><span class="p">():</span>
<span class="go">        yield [[1,2],[3,4]]</span>
<span class="go">        yield [[5,6],[7,8],[9,10]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">iterappend</span><span class="p">(</span><span class="n">ga</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[  0.   0.]</span>
<span class="go"> [  0.   0.]</span>
<span class="go"> [  0.   0.]</span>
<span class="go"> [  1.   2.]</span>
<span class="go"> [  3.   4.]</span>
<span class="go"> [  5.   6.]</span>
<span class="go"> [  7.   8.]</span>
<span class="go"> [  9.  10.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.iterview">
<code class="descname">iterview</code><span class="sig-paren">(</span><em>chunklen</em>, <em>stepsize=None</em>, <em>startindex=None</em>, <em>endindex=None</em>, <em>include_remainder=True</em>, <em>accessmode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.iterview" title="Permalink to this definition">¶</a></dt>
<dd><p>View the data array of the disk array iteratively in chunks of a
given length and with a given stepsize.</p>
<p>This method does not copy the underlying data to a new numpy array,
and is therefore relatively fast. It can also be used to change the
diskarray.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chunklen</strong> (<em>int</em>) – Size of chunk for across the first axis. Note that the last chunk
may be smaller than <cite>chunklen</cite>, depending on the size of the
first axis.</li>
<li><strong>stepsize</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Size of the shift per iteration across the first axis.
Default is None, which means that <cite>stepsize</cite> equals <cite>chunklen</cite>.</li>
<li><strong>include_remainder</strong> (<em>&lt;True</em><em>, </em><em>False&gt;</em>) – Determines whether remainder (&lt; chunklen) should be included.</li>
<li><strong>startindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Start index value.
Default is None, which means to start at the beginning.</li>
<li><strong>endindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – End index value.
Default is None, which means to end at the end.</li>
<li><strong>include_remainder</strong> – Determines if the remainder at the end of the array, if it exist,
should be yielded or not. The remainder is smaller than <cite>chunklen</cite>.
Default is True.</li>
<li><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the disk array data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a generator that produces numpy array chunks.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,),</span> <span class="n">accesmode</span><span class="o">=</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">iterview</span><span class="p">(</span><span class="n">chunklen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)):</span>
<span class="go">        ar[:] = i+1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[ 1.  1.  0.  2.  2.  0.  3.  3.  0.  4.  4.  0.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.mb">
<code class="descname">mb</code><a class="headerlink" href="#diskarray.DiskArray.mb" title="Permalink to this definition">¶</a></dt>
<dd><p>Size in megabytes of the data array.</p>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.metadata">
<code class="descname">metadata</code><a class="headerlink" href="#diskarray.DiskArray.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of meta data.</p>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.ndim">
<code class="descname">ndim</code><a class="headerlink" href="#diskarray.DiskArray.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions.</p>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.set_accessmode">
<code class="descname">set_accessmode</code><span class="sig-paren">(</span><em>accessmode</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.set_accessmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Set data access mode of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.shape">
<code class="descname">shape</code><a class="headerlink" href="#diskarray.DiskArray.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with sizes of each axis of the data array.</p>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.size">
<code class="descname">size</code><a class="headerlink" href="#diskarray.DiskArray.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of values in the data array.</p>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.store_md5checksums">
<code class="descname">store_md5checksums</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.store_md5checksums" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates md5 checksums of current data and stores them in a file
‘md5checksums.json’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A dictionary with the checksums</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="diskarray.DiskArray.storedmd5checksums">
<code class="descname">storedmd5checksums</code><a class="headerlink" href="#diskarray.DiskArray.storedmd5checksums" title="Permalink to this definition">¶</a></dt>
<dd><p>Previously stored md5 checksums of data and datadescription files.</p>
</dd></dl>

<dl class="method">
<dt id="diskarray.DiskArray.view">
<code class="descname">view</code><span class="sig-paren">(</span><em>accessmode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.DiskArray.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a memory-mapped view of the array data.</p>
<p>Although read and write operations can be performed conveniently using
indexing notation on the DiskArray object, this can be relatively slow
when performing multiple access operations in a row. To read data, the
disk file needs to be opened, data copied into memory, and after which
the file is closed. I such cases, it is much faster to use a <em>view</em> of
the disk-based data. Whenever possible, indexing operations on this
view return new views on the data, not copies. These views are lost
when the context closes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the disk array data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><em>ndarray</em> – view of disk-based array</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">accessmode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">v</span><span class="p">:</span>
<span class="go">        s1 = v[:10,1:].sum()</span>
<span class="go">        s2 = v[20:25,:2].sum()</span>
<span class="go">        v[500:] = 3.33</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="deleting-diskarrays">
<h2>Deleting diskarrays<a class="headerlink" href="#deleting-diskarrays" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="diskarray.delete_diskarray">
<code class="descclassname">diskarray.</code><code class="descname">delete_diskarray</code><span class="sig-paren">(</span><em>da</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.delete_diskarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete DiskArray data from disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>da</strong> (<a class="reference internal" href="#diskarray.DiskArray" title="diskarray.DiskArray"><em>DiskArray</em></a><em> or </em><em>str</em><em> or </em><em>pathlib.Path</em>) – The DiskArray object to be deleted or file system path to it.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="truncating-diskarrays">
<h2>Truncating diskarrays<a class="headerlink" href="#truncating-diskarrays" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="diskarray.truncate_diskarray">
<code class="descclassname">diskarray.</code><code class="descname">truncate_diskarray</code><span class="sig-paren">(</span><em>da</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#diskarray.truncate_diskarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate DiskArray data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>da</strong> (<a class="reference internal" href="#diskarray.DiskArray" title="diskarray.DiskArray"><em>DiskArray</em></a><em> or </em><em>str</em><em> or </em><em>pathlib.Path</em>) – The DiskArray object to be deleted or file system path to it.</li>
<li><strong>index</strong> (<em>int</em>) – The index along the first axis at which the diskarray should be
truncated. Negative indices can be used but the resulting length of
the truncated diskarray should be larger than 0 and smaller than the
current length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">diskarray</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_diskarray</span><span class="p">(</span><span class="s1">&#39;testarray.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">diskarray([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.],</span>
<span class="go">           [ 2.,  2.],</span>
<span class="go">           [ 3.,  3.],</span>
<span class="go">           [ 4.,  4.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">truncate_diskarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">diskarray([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.],</span>
<span class="go">           [ 2.,  2.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">truncate_diskarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">diskarray([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.]]) (r+)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">DiskArray</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Gabriel Beckers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>